# 🐋 배포 파이프라인 개선 🐋

## 🦐 Intor
과거 [EBMK](https://github.com/KIM-JS-95/PillIInfoService) 프로젝트에서 Docker를 동해 CI/CD 와 로드 밸런스를 구축했다.

완전하지는 못했지만 첫 Docker 배포라는 점에서 많은것을 배울 수 있었다.

![image](https://user-images.githubusercontent.com/65659478/182021192-3f46a9f0-4ead-4cae-b60a-714d5d86194b.png)

그리고 이번 MLP 파이널 햡업 프로젝트에서는 더욱 견고한 배포 파이프 라인을 구축하기 위해 많은 것을 개선시킬 수 있는 계기가 되었다.

## 🦐 Body

1. Geo Location 함수를 사용하고 싶다면 https를 적용하세요.

2015년부터 크롬 개발자들이 `HTTP의 보안문제`에 대해 [이슈](https://medium.com/witinweb/http-%ED%94%84%EB%A1%9C%ED%86%A0%EC%BD%9C-%EC%82%AC%EC%9A%A9%EC%8B%9C-html5-geolocation-api-%EB%93%B1-%EC%9C%84%EC%B9%98%EC%A0%95%EB%B3%B4-%EC%82%AC%EC%9A%A9%EC%A0%9C%ED%95%9C%EC%97%90-%EB%8C%80%ED%95%98%EC%97%AC-e024772cc280)
가 되면서 **GeoLocation API 기능제한**에 대한 논의가 이루어졌다.

당연하게도 이번 프로젝트에서 사용되는 기능중 하나가 `Geo Loacation`이였고 서비스 환경을 HTTPS로 변경해야했다.
정리하자면 Docker 배포환경을 구축하기 위해서는 다음과 같은 조건을 만족해야했다.

```
1. Jenkins - Docker 간에 소켓(Docker.sock) 을 적용하여 CD를 이룰 것
2. Nginx를 적용하여 LB(로드 밸런스)를 구축할 것
3. HTTPS 를 적용할 것
```
2. SSL 적용

SSL을 적용하기 위해 NginX에 무료 SSL을 적용할 수 있는 `CertBot 이미지`를 불러와야 했다.  


3. Docker-compose 를 구분한 이유는?

Jenkins 에서 빌드 체크를 수행후 Build 수행이 이루어지는데 실제 서비스가 운영된다는 가정하에 
배포가 한달에 2번 이상은 수행 될것이며 때마다 `Nginx`와 `CertBot`를 ReBuild 하는 번거로움을 피하고 싶었다.


![image](https://user-images.githubusercontent.com/65659478/182021200-4d9b4fda-ba85-4b6a-810d-fd4d086c0f61.png)

## Conclusion



## Refference
- [http 프로토콜 사용시 HTML5 Geolocation API 등 위치정보 사용제한에 대하여](https://medium.com/witinweb/http-%ED%94%84%EB%A1%9C%ED%86%A0%EC%BD%9C-%EC%82%AC%EC%9A%A9%EC%8B%9C-html5-geolocation-api-%EB%93%B1-%EC%9C%84%EC%B9%98%EC%A0%95%EB%B3%B4-%EC%82%AC%EC%9A%A9%EC%A0%9C%ED%95%9C%EC%97%90-%EB%8C%80%ED%95%98%EC%97%AC-e024772cc280)